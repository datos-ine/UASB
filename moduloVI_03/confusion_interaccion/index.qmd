---
format: 
  revealjs: 
    chalkboard: true
    logo: logos_ine.png
    incremental: false
    slide-number: true
    #footer: "Programa de Maestría en Epidemiología para la Salud Pública"
    css: custom.css
---

```{r}
#| echo: false
# Configuración global
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE,
                      fig.align = "center")

# Paquetes necesarios
pacman::p_load(
  flextable,
  patchwork,
  rio,
  janitor,
  tidyverse
)
```

## Módulo VI: Análisis Epidemiológico Avanzado {.center style="text-align: center;"}

:::: {style="margin-top: 1.5em;"}
Docentes: Tamara Ricardo, Christian Ballejo

::: {style="font-size: .75em; margin-bottom: 1.5em;"}
Programa de Maestría en Epidemiología para la Salud Pública
:::

![](logos_ine.png){fig-align="center" width="70%"}
::::

## OBJETIVOS DE LA UNIDAD

::: incremental
-   **Desarrollar habilidades en el uso de la estadística** como herramienta para la investigación epidemiológica.

-   **Adquirir competencias básicas en R y RCommander** para realizar análisis de datos en salud pública.

-   Aprender a ajustar, interpretar y evaluar modelos de **regresión lineal simple y múltiple**.

-   **Comprender los conceptos de confusión e interacción** y su impacto en los análisis estadísticos.
:::


## PROGRAMA DE LA UNIDAD

::: {style="margin-top: 2em;"}
```{r}
# Genera datos para la tabla 
tibble(Semana = c(rep("30 oct. al 03 nov. 2024", 2), 
                  rep("06 al 09 nov. 2024", 2),
                  "13 al 16 nov. 2024", ""),      
          
      Tema = c("- Introducción a los paquetes / lenguajes estadísticos: GUI vs CLI; privativos vs gratuitos/open source.",
               "- R / R-Commander: Menúes; Lectura de archivos de datos; Estadística descriptiva; Agrupamiento de variables; Factores; Guardado de script y resultados; Paquetes y plugins).",
               "- Relación entre variables: Covarianza; Correlación (Pearson, Spearman, Kendall).",
               "- Regresión lineal simple: Presupuestos; Bondad de ajuste; Coeficiente de determinación; Análisis de residuales; Interpretación.",
               "- Regresión lineal múltiple: Selección de variables; Multicolinealidad.",
               "- Confusión e interacción.")
      ) |>    
  
  #  Genera tabla    
  flextable() |>    
  bold(part = "header") |> 
  fontsize(size = 16, part = "all") |>   
  merge_v() |>  
  color(i = 1:5, color = "gray40") |> 
  highlight(i = 6, color = "#FFB90F") |> 
  autofit() 
```
:::

## ESTRUCTURA DE LA CLASE

::: {style="margin-top: 2em;"}
```{r}
# Genera datos para la tabla
tibble(
  Horario = c("18:30hs", 
             "18:40hs", 
             "20:00hs",
             "20:15hs", 
             "21:30hs"),
  
  Descripción = c("Ingreso a la videollamada", 
                  "Inicio de la clase",
                  "Receso", 
                  "Continuación clase", 
                  "Cierre")
) |> 
  
  #  Genera tabla    
  flextable() |>    
  bold(part = "header") |> 
  fontsize(size = 20, part = "all") |>   
  merge_v() |>  
  autofit() 

```
:::

## OBJETIVOS DE HOY

::: incremental
- Comprender los conceptos de confusión e interacción en los estudios epidemiológicos.

- Detectar las variables confusoras y modificadoras de efecto en las regresiones lineales.

- Interpretar los coeficientes correctamente frente al ajuste en la regresión.  

:::

## CONFUSIÓN {transition="zoom"}

::: {.callout-tip icon=false style="font-size: 1.2em;"}
## Confusión (del latín confundere, mezclar)

En términos generales, es la distorsión de una medida del efecto de una exposición sobre un resultado debido a la asociación de la exposición 
con otros factores que influyen en la ocurrencia del resultado. 
La confusión se produce cuando toda o parte de la asociación aparente entre la exposición y el resultado se explica de hecho por otras 
variables que afectan al resultado y que no se ven afectadas por la exposición.
:::

*M. Porta - A Dictionary of Epidemiology - 6th Edition - 2016*

## CONFUSIÓN

Por lo tanto, una variable confusora es una variable que distorsiona la medida de asociación entre las variables principales. El resultado, en presencia de una variable de confusión, puede ser la observación de:

- Efecto donde en realidad no existe (asociación espuria)
- Exageración o atenuación de una asociación real (confusión positiva)
- Inversión del sentido de una asociación real (confusión negativa) - paradoja de Simpson

## CONFUSIÓN

La variable confusora puede ser "real" dentro del modelo teórico estudiado y haberse recolectado en los datos (por ejemplo, la edad y el sexo son variables confusoras en muchos procesos de salud-enfermedad)

La variable confusora puede estar representada en los datos debido al desequilibrio de los grupos (heterogeneidad) pero no tener efecto confusor real en el modelo teórico.

Podría existir una variable confusora dentro del modelo teórico y no haberse medido (análisis de sensibilidad)


## CONFUSIÓN PRODUCTO DE OTROS SESGOS 

Ejemplos de causas de la confusión en estudios observacionales 

- Confusión por indicación: Al evaluar el efecto de un medicamento en particular, muchas veces las personas que toman el medicamento difieren de las que no lo toman según la indicación médica para la que se prescribe el medicamento. 

- Sesgo de selección: No todas las personas invitadas a participar en un estudio participan, lo que causa un desequilibrio entre los grupos. 

- Sesgo de recuerdo: No todas las personas con una exposición recuerdan su historial de exposición correctamente, lo que quizás cause un recuerdo desigual en diferentes grupos. 

De muchas otras maneras, incluidos grupos desequilibrados por casualidad, especialmente en estudios más pequeños.


## MODELOS TEÓRICOS - DAG

Para conceptualizar este y otros mecanismos en epidemiología se suele utilizar graficos acíclicos dirigidos (**DAG**s en inglés). 

Su nombre se debe a que no forman un ciclo cerrado y las variables están unidas por flechas dirigidas.

```{dot}
//| echo: false
//| fig-width: 6
digraph G {
  rankdir="LR";
  ratio = compress;
  size=8;
  margin=0;
  exposicion->resultado
}

```


## ggg

Un factor de confusión no debe ser un paso intermedio en la vía causal entre la exposición y el resultado.

## ROL DE LAS COVARIABLES

variables confundidoras y mediadoras

ejemplos en DAG, ejemplo en la practica

## CONTROL DE LA CONFUSIÓN

- En el diseño del estudio:
  - Aleatorización (estudios experimentales)
  - Restricción
  - Pareamiento

- Al momento de analizar los datos:
  - Estandarización (ajuste de tasas)
  - Estratificación 
  - Modelos multivariados (ajuste).

control en distintas etapas del estudio
control en la regresión multiple

## PARADOJA DE SIMPSON



## ALEATORIZACIÓN 

El objetivo de la asignación al azar de los tratamientos (exposición), que solo se puede hacer en los **estudios experimentales**, es lograr la formación de grupos homogéneos en lo que se refiere a todas las características que puedan influir en el riesgo de desarrollar el evento (edad, sexo, masa corporal u otras características que no se puedan medir), lo que se busca lograr es que los grupos sean similares en todo excepto en la exposición que se busca evaluar.

## RESTRICCIÓN

La restricción limita el estudio a personas que tienen características especiales.

## APAREAMIENTO

Cuando se controla el fenómeno de confusión mediante apareamiento,
los participantes en el estudio (casos y controles) se seleccionan de manera que los potenciales factores de confusión se encuentren distribuidos de forma similar en los dos grupos que van a compararse.

## ESTANDARIZACIÓN

## ESTRATIFICACIÓN

## ANALISIS MULTIVARIADO


## INTERPRETACIÓN EN LA RLM

En términos generales, se habla de confusión cuando existen diferencias estadísticas importantes entre las estimaciones brutas de una asociación y las ajustadas por los posibles factores de confusión. 

Existe un consenso en la bibliografía: un factor puede considerarse de confusión cuando su ajuste es responsable de un cambio de al menos un 10% en la magnitud de la diferencia entre las estimaciones ajustadas y las brutas.

Interpretación del ajuste y cuando detectar que hay confusion en la regresion

## SOSPECHA EN LA EXPLORACIÓN

sospecha gráfica
ejemplos

## EJEMPLO EN RCOMMANDER

buscar ejemplo completo

## INTERACCIÓN{transition="zoom"}

<br>

::: {.callout-note icon=false style="font-size: 1.2em;"}

## Modificación de efecto (sin.: modificación de medida de efecto) 

Variación en la medida de efecto seleccionada para el factor en estudio a través de los niveles de otro factor.

:::

*M. Porta - A Dictionary of Epidemiology - 6th Edition - 2016*

## DAG CON INTERACCIÓN

modelo DAG y ejemplo

## INTERPRETACIÓN EN LA RLM

interpretación de coeficientes en la RLM
ejemplos

## SOSPECHA EN LA EXPLORACIÓN

sospecha en gráficos

## EJEMPLO EN RCOMMANDER

ejemplo completo